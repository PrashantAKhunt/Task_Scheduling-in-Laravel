#########################################################################


Send Weekly Report to Manager using Task scheduling 

By using Task scheduling features of laravel we create one application. 
In this application we add functionality like an employee adds his task details and submit forms. and of the week automatically reports will be generated and sent to the manager.
Step 1:Create Project
Letâ€™s Start new Laravel project, for that run below command in your cmd,

composer create-project laravel/laravel SendWeeklyReport

 
Step 2:Open Project folder in cmd
Go into that project directory

cd SendWeeklyReport

Step 3:Update .env
Create database in phpMyAdmin and add configuration in .env file

DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=weekly_report ( Your Database Name)
DB_USERNAME=root
DB_PASSWORD=

Also add mail configuration in .env file

MAIL_MAILER=smtp
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=prashantkhunt1999@gmail.com
MAIL_PASSWORD=(generated by google.. click hear)
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=prashantkhunt1999@gmail.com
MAIL_FROM_NAME="${APP_NAME}"
Step 4:Create Controller
	Now create one controller for that run this command:

	php artisan make:controller TaskAddController

Step 5:Create Form in welcome.blade.php
 Now we will create one form. By using that form the employee will add all the task details. 

For that add below code in your welcome.blade.php file

<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
    <head>
 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
 
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
 
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
 
        
    </head>
    <body class="antialiased">
        <div class="div">
            <h3 class="text-center">We will send Your Weekly report to Your Manager.</h3>
        </div>
        
        <div class="container">
        @if (session('status'))
                <div class="alert alert-success">
                    {{ session('status') }}
                </div>
            @endif
        <form method="post" action="{{route('addData')}}">
        @csrf
            <h2>Employee Details</h2><br>
            <div class="form-group">
                <label>Id</label>
                <input type="number" name="e_id" class="form-control" placeholder="Enter Employee_Id">
            </div>
            <div class="form-group">
                <label>Name</label>
                <input type="text" name="e_name" class="form-control" placeholder="Enter Your Name">
            </div>
            <div class="form-group">
                <label>Email address</label>
                <input type="email" name="e_email" class="form-control" placeholder="Enter Your Email">    
            </div>
            <div class="form-group">
            <h2>Task Details</h2><br>
                <div class="form-group">
                <label>Monday</label>
                <input type="text" name="t_mon" class="form-control" placeholder="Task done by Monday">
                </div>
 
                <div class="form-group">
                <label>Tuesday</label>
                <input type="text" name="t_tue" class="form-control" placeholder="Task done by Tuesday">
                </div>
 
                <div class="form-group">
                <label>Wednesday</label>
                <input type="text" name="t_wed" class="form-control" placeholder="Task done by Wednesday">
                </div>
 
                <div class="form-group">
                <label>Thursday</label>
                <input type="text" name="t_thu" class="form-control" placeholder="Task done by Thursday">
                </div>
 
                <div class="form-group">
                <label>Friday</label>
                <input type="text" name="t_fri" class="form-control" placeholder="Task done by Friday">
                </div>
            </div>
            <div class="form-group">
                
            </div>
            
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        
        </div>
    </body>
</html>
 


Step 6:Update route
Now we add route in web.php file, so add below code in web.php file

use App\Http\Controllers\TaskAddController;
Route::post('/addData',[TaskAddController::class,'addTask'])->name('addData');


Step 7:Create Model and Migration

In this step we will create one model and migration file to save the report of the employee. For that apply a given command..

php artisan make:model AddTask -m

After creating the migration file add table structure in that file..

<?php 
 
use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;
 
class CreateAddTasksTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('add_tasks', function (Blueprint $table) {
            $table->id();
            $table->bigInteger('e_id');
            $table->string('e_name');
            $table->string('e_email');
            $table->string('t_mon');
            $table->string('t_tue');
            $table->string('t_wed');
            $table->string('t_thu');
            $table->string('t_fri');
            $table->timestamps();
        });
    }
 
    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('add_tasks');
    }
}
 


Step 8: Update Controller

Now update TaskAddController and add below code:

 <?php
 
namespace App\Http\Controllers;
 
use Illuminate\Http\Request;
use App\Models\AddTask;
 
class TaskAddController extends Controller
{
    public function addTask(Request $request)
    {
        $data = $request->all();
        $task = new AddTask();
 
        $task->e_id = $data['e_id'];
        $task->e_name = $data['e_name'];
        $task->e_email = $data['e_email'];
        $task->t_mon = $data['t_mon'];
        $task->t_tue = $data['t_tue'];
        $task->t_wed = $data['t_wed'];
        $task->t_thu = $data['t_thu'];
        $task->t_fri = $data['t_fri'];
        $task->save();
        return back()->with('status','Data added successfully');
    }
 
    
 
}
 


Step 9:Create Mail class with Markdown
Now we create one mail class with markdown
For that apply the below command.
	
php artisan make:mail WeeklyReport --markdown=emails.weeklyReport


Step 10: Update Mail class
Now we update App\Mail\WeeklyReport.php 

<?php
 
namespace App\Mail;
 
use Illuminate\Bus\Queueable;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Mail\Mailable;
use Illuminate\Queue\SerializesModels;
 
class WeeklyReport extends Mailable
{
    use Queueable, SerializesModels;
 
    public $body;
 
    /**
     * Create a new message instance.
     *
     * @return void
     */
    public function __construct($body)
    {
        $this->body = $body;
    }
 
    /**
     * Build the message.
     *
     * @return $this
     */
    public function build()
    {
        return $this->markdown('email.weeklyReport');
    }
}
 

And views\email\weeklyReport.blade.php

 
Hello..
 
This mail contains Weekly report of your Team.
 
<style>
    table, th, td {
         border: 1px solid black;
    }
 
    table {
        width: 100%;
        border-collapse: collapse;
    }
 
</style>
 
<table >
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Monday</th>
        <th>Tuesday</th>
        <th>Wednesday</th>
        <th>Thursday</th>
        <th>Friday</th>
    </tr>
    </thead>
    <tbody>
    @foreach($body as $user)
    <tr>
        <td>{{$user->e_id}}</td>
        <td>{{$user->e_name}}</td>
        <td>{{$user->e_email}}</td>
        <td>{{$user->t_mon}}</td>
        <td>{{$user->t_tue}}</td>
        <td>{{$user->t_wed}}</td>
        <td>{{$user->t_thu}}</td>
        <td>{{$user->t_fri}}</td>
    </tr>
    @endforeach
    </tbody>
</table>




 

Step 11:Create Artisan command

Now we create artisan command, by using that command we can send report.

For create new artisan command 

php artisan make:command sendWeeklyReport
Now goto the App\Console\Commands\sendWeeklyReport.php  and add

<?php
 
namespace App\Console\Commands;
 
use Illuminate\Console\Command;
use App\Models\AddTask;
use App\Mail\WeeklyReport;
use Mail;
class sendWeeklyReport extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'weekly:mail_report';
 
    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Weekly report send to Manager';
 
    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct()
    {
        parent::__construct();
    }
 
    /**
     * Execute the console command.
     *
     * @return int
     */
    public function handle()
    {
        $emp = AddTask::all();
 
        $email = 'prashantkhunt1999@gmail.com';
 
        $body = $emp;
 
        Mail::to($email)->send(new WeeklyReport($body));
 
        $this->info('Weekly report has been send successfully');
    }
}
 


Step 12:Schedule command

Open App\Console\Kernal.php and add scheduler. For that update schedule method of that class



    protected function schedule(Schedule $schedule)
    {
        $schedule->command('weekly:mail_report')->weekly();
    }
 

Now All are ready..

For run scheduler locally run command

php artisan schedule:work

and for run project apply 

php artisan serve

###########################################################




<p align="center"><a href="https://laravel.com" target="_blank"><img src="https://raw.githubusercontent.com/laravel/art/master/logo-lockup/5%20SVG/2%20CMYK/1%20Full%20Color/laravel-logolockup-cmyk-red.svg" width="400"></a></p>

<p align="center">
<a href="https://travis-ci.org/laravel/framework"><img src="https://travis-ci.org/laravel/framework.svg" alt="Build Status"></a>
<a href="https://packagist.org/packages/laravel/framework"><img src="https://img.shields.io/packagist/dt/laravel/framework" alt="Total Downloads"></a>
<a href="https://packagist.org/packages/laravel/framework"><img src="https://img.shields.io/packagist/v/laravel/framework" alt="Latest Stable Version"></a>
<a href="https://packagist.org/packages/laravel/framework"><img src="https://img.shields.io/packagist/l/laravel/framework" alt="License"></a>
</p>

## About Laravel

Laravel is a web application framework with expressive, elegant syntax. We believe development must be an enjoyable and creative experience to be truly fulfilling. Laravel takes the pain out of development by easing common tasks used in many web projects, such as:

- [Simple, fast routing engine](https://laravel.com/docs/routing).
- [Powerful dependency injection container](https://laravel.com/docs/container).
- Multiple back-ends for [session](https://laravel.com/docs/session) and [cache](https://laravel.com/docs/cache) storage.
- Expressive, intuitive [database ORM](https://laravel.com/docs/eloquent).
- Database agnostic [schema migrations](https://laravel.com/docs/migrations).
- [Robust background job processing](https://laravel.com/docs/queues).
- [Real-time event broadcasting](https://laravel.com/docs/broadcasting).

Laravel is accessible, powerful, and provides tools required for large, robust applications.

## Learning Laravel

Laravel has the most extensive and thorough [documentation](https://laravel.com/docs) and video tutorial library of all modern web application frameworks, making it a breeze to get started with the framework.

If you don't feel like reading, [Laracasts](https://laracasts.com) can help. Laracasts contains over 1500 video tutorials on a range of topics including Laravel, modern PHP, unit testing, and JavaScript. Boost your skills by digging into our comprehensive video library.

## Laravel Sponsors

We would like to extend our thanks to the following sponsors for funding Laravel development. If you are interested in becoming a sponsor, please visit the Laravel [Patreon page](https://patreon.com/taylorotwell).

### Premium Partners

- **[Vehikl](https://vehikl.com/)**
- **[Tighten Co.](https://tighten.co)**
- **[Kirschbaum Development Group](https://kirschbaumdevelopment.com)**
- **[64 Robots](https://64robots.com)**
- **[Cubet Techno Labs](https://cubettech.com)**
- **[Cyber-Duck](https://cyber-duck.co.uk)**
- **[Many](https://www.many.co.uk)**
- **[Webdock, Fast VPS Hosting](https://www.webdock.io/en)**
- **[DevSquad](https://devsquad.com)**
- **[Curotec](https://www.curotec.com/services/technologies/laravel/)**
- **[OP.GG](https://op.gg)**

## Contributing

Thank you for considering contributing to the Laravel framework! The contribution guide can be found in the [Laravel documentation](https://laravel.com/docs/contributions).

## Code of Conduct

In order to ensure that the Laravel community is welcoming to all, please review and abide by the [Code of Conduct](https://laravel.com/docs/contributions#code-of-conduct).

## Security Vulnerabilities

If you discover a security vulnerability within Laravel, please send an e-mail to Taylor Otwell via [taylor@laravel.com](mailto:taylor@laravel.com). All security vulnerabilities will be promptly addressed.

## License

The Laravel framework is open-sourced software licensed under the [MIT license](https://opensource.org/licenses/MIT).



